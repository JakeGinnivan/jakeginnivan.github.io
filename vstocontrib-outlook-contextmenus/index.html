
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>VSTOContrib Context Menus - Jake Ginnivan's blog</title>
  <meta name="author" content="Jake Ginnivan">

  
  <meta name="description" content="An issue for VSTO Contrib was submitted, it was hard to wire up context menus, this is now fixed">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://JakeGinnivan.github.io/vstocontrib-outlook-contextmenus/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/feed/index.xml" rel="alternate" title="Jake Ginnivan's blog" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-42948513-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Jake Ginnivan's blog</a></h1>
  
  <ul class="social-links">
  
    <li><a class="feed" href="/feed/index.xml" title="RSS"></a></li>
  
  
    <li><a class="twitter" href="http://twitter.com/JakeGinnivan" title="Twitter" target="_black"></a></li>
  
  
    <li><a class="github" href="https://github.com/JakeGinnivan" title="GitHub" target="_black"></a></li>
  
</ul>
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/feed/index.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:JakeGinnivan.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/about-me">About</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">VSTOContrib Context Menus</h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-08-22T00:00:00+01:00" pubdate data-updated="true">Aug 22<span>nd</span>, 2012</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>So the scenario was that I want to show additional menu items when right clicking on an email.</p>

<!-- more -->


<pre><code>&lt;contextMenus&gt;
  &lt;contextMenu idMso="ContextMenuMailItem"&gt;
    &lt;button id="MyContextMenuMailItem"
            label="Perform the action..."
            onAction="EmailItems"
            imageMso="Forward"/&gt;
  &lt;/contextMenu&gt;
  &lt;contextMenu idMso="ContextMenuMultipleItems"&gt;
    &lt;button id="MyContextMenuMultipleItems"
        label="Perform the action on multiple items..."
        onAction="EmailItems"
        imageMso="Forward"/&gt;
  &lt;/contextMenu&gt;
&lt;/contextMenus&gt;
</code></pre>

<p>In the current release, the EmailItems callback would never be called. This is because of the way Outlook handles selections and context menus. VSTOContrib now correctly routes the callbacks to the correct viewmodel.</p>

<p>Now you can simply add the callback to your viewmodel like this:</p>

<pre><code>[OutlookRibbonViewModel(OutlookRibbonType.OutlookExplorer)]
public class ExplorerViewModel : OfficeViewModelBase, IRibbonViewModel
{
    Folder context;
    Explorer explorer;

    public IRibbonUI RibbonUi { get; set; }
    public void Initialised(object context)
    {
        this.context = (Folder) context;
    }

    public void EmailItems(IRibbonControl control)
    {
        if (explorer.Selection.Count == 1)
        {
            var title = ((MailItem) explorer.Selection[1]).Subject;
        }
    }

    public void CurrentViewChanged(object currentView)
    {
        explorer = (Explorer) currentView;
    }

    public void Cleanup()
    {
    }
}
</code></pre>

<p>And you will get the EmailItems callback as you would expect. I also recommend putting a getVisible callback to hide the menu item if the selection does not contain mail items for instance.</p>

<p>Hope this helps someone.</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Jake Ginnivan</span></span>

      








  


<time datetime="2012-08-22T00:00:00+01:00" pubdate data-updated="true">Aug 22<span>nd</span>, 2012</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/vsto/'>VSTO</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://JakeGinnivan.github.io/vstocontrib-outlook-contextmenus/" data-via="JakeGinnivan" data-counturl="http://JakeGinnivan.github.io/vstocontrib-outlook-contextmenus/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/web-api-problem-404s-for-everything/" title="Previous Post: Web Api Problem - 404s for everything">&laquo; Web Api Problem - 404s for everything</a>
      
      
        <a class="basic-alignment right" href="/async-warning-with-nsubstitute/" title="Next Post: Async warning with nSubstitute">Async warning with nSubstitute &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014/01/05/blog-migration/">Blog Migration</a>
      </li>
    
      <li class="post">
        <a href="/gitreleasenotes/">GitReleaseNotes Initial Release!</a>
      </li>
    
      <li class="post">
        <a href="/git-flow-versioning/">Git Flow Versioning</a>
      </li>
    
      <li class="post">
        <a href="/release-nuget-semver-packages-from-teamcity/">Release NuGet SemVer packages from Teamcity</a>
      </li>
    
      <li class="post">
        <a href="/conventiontests-v2-released/">Convention Tests v2 Released</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/JakeGinnivan">@JakeGinnivan</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'JakeGinnivan',
            count: 6,
            skip_forks: false,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>

<section>
  <h1>Categories</h1>
  <ul id="category-list"><li><a href='/blog/categories/dot-net/'>.NET (6)</a></li><li><a href='/blog/categories/async/'>Async (2)</a></li><li><a href='/blog/categories/automapper/'>AutoMapper (1)</a></li><li><a href='/blog/categories/azure/'>Azure (3)</a></li><li><a href='/blog/categories/clickonce/'>ClickOnce (3)</a></li><li><a href='/blog/categories/continuous-delivery/'>Continuous Delivery (2)</a></li><li><a href='/blog/categories/git/'>Git (3)</a></li><li><a href='/blog/categories/gitflow/'>GitFlow (1)</a></li><li><a href='/blog/categories/github/'>GitHub (3)</a></li><li><a href='/blog/categories/jira/'>Jira (1)</a></li><li><a href='/blog/categories/log4net/'>log4net (1)</a></li><li><a href='/blog/categories/msbuild/'>MSBuild (1)</a></li><li><a href='/blog/categories/nuget/'>NuGet (3)</a></li><li><a href='/blog/categories/open-source/'>Open Source (20)</a></li><li><a href='/blog/categories/presenting/'>Presenting (8)</a></li><li><a href='/blog/categories/resharper/'>ReSharper (2)</a></li><li><a href='/blog/categories/semantic-versioning/'>Semantic Versioning (1)</a></li><li><a href='/blog/categories/teamcity/'>TeamCity (5)</a></li><li><a href='/blog/categories/testing/'>Testing (5)</a></li><li><a href='/blog/categories/teststack/'>TestStack (2)</a></li><li><a href='/blog/categories/tfs/'>TFS (2)</a></li><li><a href='/blog/categories/ui-automation/'>UI Automation (6)</a></li><li><a href='/blog/categories/vsto/'>VSTO (17)</a></li><li><a href='/blog/categories/webapi/'>WebApi (1)</a></li><li><a href='/blog/categories/white/'>White (2)</a></li><li><a href='/blog/categories/windows-phone/'>Windows Phone (9)</a></li><li><a href='/blog/categories/wpf/'>Wpf (8)</a></li></ul>
</section>



  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Jake Ginnivan -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
  - <span class="credit">Theme by <a href="http://www.gehaxelt.in">Gehaxelt</a></span>
  <span class="credit">and <a href="http://www.it-solutions-neef.de">IT Solutions Neef</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'jakeginnivansblog';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://JakeGinnivan.github.io/vstocontrib-outlook-contextmenus/';
        var disqus_url = 'http://JakeGinnivan.github.io/vstocontrib-outlook-contextmenus/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
