
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>TeamCity Build Results in TFS - Jake Ginnivan's blog</title>
  <meta name="author" content="Jake Ginnivan">

  
  <meta name="description" content="Why? Recently I have been working with testers on our team, and trying to bring testing closer to our sprints. We use Microsoft Test Manager for our &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://JakeGinnivan.github.io/teamcity-build-results-in-tfs">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Jake Ginnivan's blog" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-42948513-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Jake Ginnivan's blog</a></h1>
  
    <h2>Things I find useful</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:JakeGinnivan.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">TeamCity Build Results in TFS</h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-04-13T00:00:00+01:00" pubdate data-updated="true">Apr 13<span>th</span>, 2013</time>
        
      </p>
    
  </header>


<div class="entry-content"><h1>Why?</h1>

<p>Recently I have been working with testers on our team, and trying to bring testing closer to our sprints. We use Microsoft Test Manager for our test tool, TFS for work items, GitHub for source control and TeamCity for our build server.</p>

<p>All our tests are written using xUnit.net. When you start working with testers it becomes important to surface your automated and manual testing together, so testers can work more efficiently and have more confidence in the software the team is producing.</p>

<p>Enter TFS. TFS is a great product that starts really value adding when you use different components together, the testing tools is an example of this. When you use Team Build with the testing tools, a heap of features and workflows start working way better!</p>

<h1>What?</h1>

<p>My goal is to have my automated regression tests (both UI and Integration tests) which are written in xUnit to report their results back into TFS (Builds) and Test Manager (Test Runs).</p>

<p>This allows the Testers to use the planned automation features in TFS to mark certain Test Cases as &lsquo;Planned&rsquo; for automation, it also lights up a whole lot of reporting around test case readiness and other things.</p>

<!-- more -->


<h1>How?</h1>

<p>There are a few parts to automatically marking test cases as passed/failed.</p>

<ol>
<li>Associated Automation<br/>
If you open a test case up in Visual Studio, you can assign an MSTest test to a test case<br/>
<img src="/assets/posts/2013-04-13-teamcity-build-results-in-tfs/TeamCityBuildResultsinTFS1_635014894026562500.png" alt="TeamCityBuildResultsinTFS1" /></li>
<li>Get a .trx file which can be published to TFS (By using VSTest.Console with the TeamCityAndTrx logger)
<img src="/assets/posts/2013-04-13-teamcity-build-results-in-tfs/TeamCityBuildResultsinTFS2_635014894036562500.png" alt="TeamCityBuildResultsinTFS2" /><br/>
<img src="/assets/posts/2013-04-13-teamcity-build-results-in-tfs/TeamCityBuildResultsinTFS3_635014894039375000.png" alt="TeamCityBuildResultsinTFS3" /></li>
<li>Publish the build using TfsBuildResultPublisher (see <a href="https://github.com/JakeGinnivan/TfsBuildResultPublisher/blob/master/BuildAndPublish.msbuild">BuildAndPublish.msbuild</a> for an example)</li>
<li>A test run created in Test Manager which can be linked to a test suite, this will automatically pass/fail a test.</li>
</ol>


<p>I have built a few projects which glue this all together.</p>

<h2>1. VSTest.TeamCityLogger</h2>

<p>The first step is I have xUnit tests, luckily Visual Studio 2012 has a new test runner, this introduces <a href="http://msdn.microsoft.com/en-us/library/hh598952.aspx">Unit Test Adapters</a> to support third party test frameworks.</p>

<p>The new test runner has a command line version too called VSTest.Console.exe which allows you to specify which logger to use, out of the box there is a <code>trxLogger</code> to output a .trx file for any framework.</p>

<p>VSTest.TeamCityLogger introduces two new loggers <code>TeamCityLogger</code> and <code>TeamCityAndTrxLogger</code>, the first simply exposes VSTest results to TeamCity, the second also outputs a .trx file.</p>

<p>Now we have a TeamCity build, which exports a .trx file!</p>

<p>More information available at <a href="https://github.com/JakeGinnivan/VSTest.TeamCityLogger">https://github.com/JakeGinnivan/VSTest.TeamCityLogger</a></p>

<h2>2. TfsBuildResultPublisher</h2>

<p>The next part of the puzzle is getting the build into TFS, this is where TfsBuildResultPublisher comes in.
It is based off Based off <a href="http://blogs.msdn.com/b/jpricket/archive/2010/02/23/creating-fake-builds-in-tfs-build-2010.aspx">http://blogs.msdn.com/b/jpricket/archive/2010/02/23/creating-fake-builds-in-tfs-build-2010.aspx</a> and <a href="http://msmvps.com/blogs/vstsblog/archive/2011/04/26/creating-fake-builds-in-tfs-build-2010-using-the-command-line.aspx">http://msmvps.com/blogs/vstsblog/archive/2011/04/26/creating-fake-builds-in-tfs-build-2010-using-the-command-line.aspx</a> but it provides a heap of additional options, like:</p>

<ul>
<li>Publish Test Results, if you simply want to publish a .trx into your build, TfsCreateBuild will take care of that for you.</li>
<li>Publish Test Run to MTM (Microsoft Test Manager)

<ul>
<li>In addition to this, VSTest.Console.exe generates different testId&rsquo;s to MSTest, this means that MTM will not recognise the associated tests (I am coming to this soon!). TfsCreateBuild has a flag to fix your .trx file and correct the testId&rsquo;s so the automation is matched.</li>
</ul>
</li>
</ul>


<p>More information available at <a href="https://github.com/JakeGinnivan/TfsBuildResultPublisher">https://github.com/JakeGinnivan/TfsBuildResultPublisher</a></p>

<h2>TestCaseAutomationAssigner</h2>

<p>I mentioned earlier my tests are xUnit.net and that visual studio only lets you associate MSTest tests with Test Cases.</p>

<p>This is where <a href="https://github.com/JakeGinnivan/TestCaseAutomationAssigner">https://github.com/JakeGinnivan/TestCaseAutomationAssigner</a> comes in. It is a simple WPF application which allows you to associate either xUnit.net or NUnit tests with Test Cases.</p>

<p>You can install this from <a href="http://teamcity.ginnivan.net/guestAuth/repository/download/bt48/.lastSuccessful/ClickOnce/TestCaseAutomationAssigner.application">http://teamcity.ginnivan.net/guestAuth/repository/download/bt48/.lastSuccessful/ClickOnce/TestCaseAutomationAssigner.application</a></p>

<h1>Summary</h1>

<p>Using TestCaseAutomationAssigner, TfsCreateBuild and VSTest.TeamCityLogger you can use TeamCity as your build server, xUnit or NUnit as your unit test framework and report the results back into Test Manager and TFS giving you all the reportability and value that comes with TFS when you use all the features!</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Jake Ginnivan</span></span>

      








  


<time datetime="2013-04-13T00:00:00+01:00" pubdate data-updated="true">Apr 13<span>th</span>, 2013</time>
      


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://JakeGinnivan.github.io/teamcity-build-results-in-tfs/" data-via="JakeGinnivan" data-counturl="http://JakeGinnivan.github.io/teamcity-build-results-in-tfs/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/redirecting-process-output/" title="Previous Post: Redirecting Process Output">&laquo; Redirecting Process Output</a>
      
      
        <a class="basic-alignment right" href="/documentation-site-with-pretzel/" title="Next Post: Documentation Site with Pretzel">Documentation Site with Pretzel &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/gitreleasenotes/">GitReleaseNotes Initial Release!</a>
      </li>
    
      <li class="post">
        <a href="/git-flow-versioning/">Git Flow Versioning</a>
      </li>
    
      <li class="post">
        <a href="/release-nuget-semver-packages-from-teamcity/">Release NuGet SemVer Packages From Teamcity</a>
      </li>
    
      <li class="post">
        <a href="/conventiontests-v2-released/">Convention Tests V2 Released</a>
      </li>
    
      <li class="post">
        <a href="/pack-uri-in-unit-tests/">Pack URI in Unit Tests</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/JakeGinnivan">@JakeGinnivan</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'JakeGinnivan',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Jake Ginnivan -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'jakeginnivansblog';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://JakeGinnivan.github.io/teamcity-build-results-in-tfs/';
        var disqus_url = 'http://JakeGinnivan.github.io/teamcity-build-results-in-tfs/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
